<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Redirect Login/Signup</title>
<style>
  * {
    margin: 0; padding: 0; box-sizing: border-box;
    font-family: "Poppins", sans-serif;
  }
  body {
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    min-height: 100vh;
    display: flex; justify-content: center; align-items: center;
    color: white;
    padding: 20px;
  }
  .container {
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 40px 30px;
    width: 90%;
    max-width: 400px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    text-align: center;
  }
  h2 {
    margin-bottom: 20px;
    font-size: 24px;
  }
  input {
    width: 100%;
    padding: 12px;
    border: 1px solid #555;
    outline: none;
    border-radius: 8px;
    margin-bottom: 15px;
    font-size: 14px;
    background: #2b2b2b;
    color: #fff;
  }
  .password-wrapper {
    position: relative;
    width: 100%;
    margin-bottom: 15px;
  }
  .password-wrapper input {
    margin-bottom: 0;
    padding-right: 45px;
  }
  .password-wrapper span {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 20px;
  }
  .form-btn {
    width: 100%; padding: 12px;
    border: none; border-radius: 8px;
    background: #FFD700;
    color: black; font-weight: 700;
    cursor: pointer;
    transition: 0.3s;
    font-size: 16px;
  }
  .form-btn:hover { background: #ffcc00; }
  .switch-form {
      margin-top: 20px;
      font-size: 14px;
  }
  .switch-form a {
      color: #00bfff;
      cursor: pointer;
      text-decoration: none;
      font-weight: 600;
  }
  .switch-form a:hover {
      text-decoration: underline;
  }
  .message {
      margin-bottom: 15px;
      font-size: 14px;
      min-height: 20px;
  }
  .message.success { color: #90ee90; }
  .message.error { color: tomato; }
  
  /* Generator section */
  .generator {
    display: none; /* Initially hidden */
  }
  .generator input {
    width: 100%;
    margin-bottom: 10px;
  }
  .output {
    margin-top: 15px;
    font-size: 14px;
    color: #90ee90;
    word-break: break-all;
    background: rgba(0,0,0,0.2);
    padding: 10px;
    border-radius: 8px;
    min-height: 50px;
  }
  .logout-btn {
    margin-top: 20px;
    padding: 8px 16px;
    border: none;
    background: #ff4040;
    color: white;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
  }
</style>
</head>
<body>

<!-- Login Form -->
<div class="container" id="loginContainer">
  <h2>Welcome Back!</h2>
  <div id="loginMessage" class="message"></div>
  <form id="loginForm" onsubmit="handleLogin(event)">
    <input type="email" name="email" placeholder="Enter your email" required>
    <div class="password-wrapper">
      <input type="password" name="password" placeholder="Enter your password" required>
      <span onclick="togglePassword(this)">üëÅÔ∏è</span>
    </div>
    <button type="submit" class="form-btn">Log In</button>
  </form>
  <div class="switch-form">
    Don't have an account? <a onclick="showSignup()">Sign Up</a>
  </div>
</div>

<!-- Signup Form -->
<div class="container" id="signupContainer" style="display:none;">
  <h2>Create Account</h2>
  <div id="signupMessage" class="message"></div>
  <form id="signupForm" onsubmit="handleSignup(event)">
    <input type="email" name="email" placeholder="Enter your email" required>
    <div class="password-wrapper">
      <input type="password" name="password" placeholder="Create a password" required>
      <span onclick="togglePassword(this)">üëÅÔ∏è</span>
    </div>
    <button type="submit" class="form-btn">Sign Up</button>
  </form>
  <div class="switch-form">
    Already have an account? <a onclick="showLogin()">Log In</a>
  </div>
</div>

<!-- Generator Box -->
<div class="container generator" id="generatorBox">
  <h2>Smart Redirect Generator</h2>
  <input type="text" id="linkInput" placeholder="Enter your original link...">
  <button class="form-btn" onclick="generateLink()">Generate</button>
  <div class="output" id="output"></div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<script>
  // DOM Elements
  const loginContainer = document.getElementById('loginContainer');
  const signupContainer = document.getElementById('signupContainer');
  const generatorBox = document.getElementById('generatorBox');
  const loginMessage = document.getElementById('loginMessage');
  const signupMessage = document.getElementById('signupMessage');

  // Utility Functions
  const showLogin = () => {
    signupContainer.style.display = 'none';
    loginContainer.style.display = 'block';
    generatorBox.style.display = 'none';
  };

  const showSignup = () => {
    loginContainer.style.display = 'none';
    signupContainer.style.display = 'block';
    generatorBox.style.display = 'none';
  };

  const showGenerator = () => {
    loginContainer.style.display = 'none';
    signupContainer.style.display = 'none';
    generatorBox.style.display = 'block';
  };

  const togglePassword = (icon) => {
    const passwordField = icon.previousElementSibling;
    if (passwordField.type === "password") {
      passwordField.type = "text";
      icon.textContent = "üôà";
    } else {
      passwordField.type = "password";
      icon.textContent = "üëÅÔ∏è";
    }
  };

  // -- Authentication Logic --

  // Get users from localStorage
  const getUsers = () => {
    const users = localStorage.getItem('smartRedirectUsers');
    return users ? JSON.parse(users) : {};
  };

  // Save users to localStorage
  const saveUsers = (users) => {
    localStorage.setItem('smartRedirectUsers', JSON.stringify(users));
  };

  // Handle Signup
  const handleSignup = (event) => {
    event.preventDefault();
    const form = event.target;
    const email = form.email.value.trim();
    const password = form.password.value.trim();
    
    const users = getUsers();

    if (users[email]) {
      signupMessage.textContent = 'Email is already registered!';
      signupMessage.className = 'message error';
      return;
    }

    // Ek real app me, password ko hash karna chahiye
    // For example: const hashedPassword = await bcrypt.hash(password, 10);
    users[email] = password; 
    saveUsers(users);

    signupMessage.textContent = 'Signup successful! Please log in.';
    signupMessage.className = 'message success';
    
    form.reset();
    setTimeout(() => {
        showLogin();
        signupMessage.textContent = '';
    }, 2000);
  };

  // Handle Login
  const handleLogin = (event) => {
    event.preventDefault();
    const form = event.target;
    const email = form.email.value.trim();
    const password = form.password.value.trim();

    const users = getUsers();
    const storedPassword = users[email];

    if (storedPassword && storedPassword === password) {
      // Use sessionStorage to keep user logged in only for the session
      sessionStorage.setItem('isLoggedIn', 'true');
      showGenerator();
      loginMessage.textContent = '';
      form.reset();
    } else {
      loginMessage.textContent = 'Invalid email or password.';
      loginMessage.className = 'message error';
    }
  };

  // Logout
  const logout = () => {
    sessionStorage.removeItem('isLoggedIn');
    showLogin();
  };

  // -- Generator Logic --
  const generateLink = () => {
    const input = document.getElementById('linkInput').value.trim();
    const output = document.getElementById('output');
    if (!input) {
      output.textContent = "Please enter a valid link!";
      output.style.color = "tomato";
      return;
    }
    const code = Math.random().toString(36).substring(2, 8);
    const customLink = `https://your-domain.com/redirect?code=${code}`;
    output.style.color = "#90ee90";
    output.innerHTML = `<b>Generated Link:</b><br>${customLink}`;
  };

  // -- Initial Check on Page Load --
  window.onload = () => {
    if (sessionStorage.getItem('isLoggedIn') === 'true') {
      showGenerator();
    } else {
      showLogin();
    }
  };
</script>

</body>
</html>
